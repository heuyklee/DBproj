var test = require('tape')
var FacebookMessenger = require('./')
var config = require('./config.json')
var messenger = new FacebookMessenger(config.token, 'SILENT_PUSHf')

messenger.setWelcomeMessage(config.pageId, 'Bienvenid@ a Kiwi, escribe cualquier cosa para iniciar el bot', function (err, body) {
  if (err) return console.error(err)
  console.log(body)
})

/*
var receipt = {
  'recipient_name': 'Diego Rodríguez Baquero',
  'order_number': (new Date()).getTime(),
  'currency': 'USD',
  'payment_method': 'Efectivo',
  'elements': [
    {
      'title': 'Sushi Cangrejo',
      'subtitle': 'Caja de Sushi',
      'price': 10000,
      'image_url': 'https://cdn.pide.kiwi/Happy_BLT.jpg'
    },
    {
      'title': 'Hatsu Blanco Mangostino',
      'subtitle': 'Bebida',
      'price': 4000
    }
  ],
  'summary': {
    'shipping_cost': '1900',
    'total_cost': '14000'
  }
}

messenger.sendReceiptMessage(config.userId, receipt, function (err, body) {
  if(err) return console.error(err)
  console.log(body)
})


var offers = [{
  'title': 'Juan Valdez Café',
  'image_url': 'http://3.bp.blogspot.com/-XrxK9PikDio/VcWGCdygeYI/AAAAAAABIMM/Sr7EWgdLC9k/s1600/valdez_0.jpg',
  'subtitle': 'Barista part/full. Sin experiencia. Las Condones / Providencia.',
  'buttons': [{
    'type': 'web_url',
    'title': 'Más información',
    'url': 'https://labora.today/...'
  },{
    'type': 'postback',
    'title': 'Aplicar',
    'payload': 'action2'
  },{
    'type': 'web_url',
    'title': 'Extra',
    'url': 'https://labora.today/...'
  }]
}, {
  'title': 'San Camilo Pastelería',
  'image_url': 'http://www.datoexpress.cl/wp-content/uploads/2015/04/SAN-CAMILO.jpg',
  'subtitle': 'Cajero full-time. Sin experiencia. Centro.',
  'buttons': [{
    'type': 'web_url',
    'title': 'Más información',
    'url': 'https://labora.today/...'
  },{
    'type': 'postback',
    'title': 'Aplicar',
    'payload': 'action'
  },{
    'type': 'web_url',
    'title': 'Extra',
    'url': 'https://labora.today/...'
  }]
}]
messenger.sendGenericMessage(config.userId, offers, function (err, body) {
  if (err) return console.error(err)
  console.log(body)
})


test('Send text message', function (t) {
  t.plan(3)

  messenger.sendTextMessage(config.userId, 'Hola', function (err, body) {
    if (err) {
      t.error(err)
    }
    console.log(body)
    t.ok('Text')
  })
  messenger.sendImageMessage(config.userId, 'http://i.imgur.com/PxyMnRs.gif', function (err, body) {
    if (err) {
      t.error(err)
    }
    console.log(body)
    t.ok('Image')
  })

  messenger.getProfile(config.userId, function (err, body) {
    if (err) {
      t.error(err)
    }
    console.log(body)
    t.ok('Profile')
  })
})
*/